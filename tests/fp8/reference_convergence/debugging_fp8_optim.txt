##### Running reference ##### 

[Ref Adam] original grad: tensor([[-0.5228, -4.5139],
        [-0.5228, -4.5139]], device='cuda:0')
[Ref Adam] original exp_avg: exp_avg.data=tensor([[0., 0.],
        [0., 0.]], device='cuda:0'), exp_avg.dtype=torch.float32 
 

[Ref Adam] original exp_avg_sq: exp_avg_sq.data=tensor([[0., 0.],
        [0., 0.]], device='cuda:0'), exp_avg_sq.dtype=torch.float32 
 

[Ref Adam] beta1: 0.9, beta2: 0.999
[Ref Adam]: bias_correction1: 0.09999999999999998, bias_correction2: 0.0010000000000000009
[Ref Adam] after mul and add: exp_avg: tensor([[-0.0523, -0.4514],
        [-0.0523, -0.4514]], device='cuda:0') 
 

[Ref Adam] after mul and add: exp_avg_sq: tensor([[0.0003, 0.0204],
        [0.0003, 0.0204]], device='cuda:0') 
 

[Ref Adam] denom: tensor([[0.5228, 4.5139, 2.9656, 1.5045, 1.2760, 1.8316, 4.0147, 0.1146, 0.2366,
         2.9126, 0.5876, 3.8915, 0.9933, 4.1285, 2.7466, 3.4808],
        [0.5228, 4.5139, 2.9656, 1.5045, 1.2760, 1.8316, 4.0147, 0.1146, 0.2366,
         2.9126, 0.5876, 3.8915, 0.9933, 4.1285, 2.7466, 3.4808],
        [0.5228, 4.5139, 2.9656, 1.5045, 1.2760, 1.8316, 4.0147, 0.1146, 0.2366,
         2.9126, 0.5876, 3.8915, 0.9933, 4.1285, 2.7466, 3.4808],
        [0.5228, 4.5139, 2.9656, 1.5045, 1.2760, 1.8316, 4.0147, 0.1146, 0.2366,
         2.9126, 0.5876, 3.8915, 0.9933, 4.1285, 2.7466, 3.4808],
        [0.5228, 4.5139, 2.9656, 1.5045, 1.2760, 1.8316, 4.0147, 0.1146, 0.2366,
         2.9126, 0.5876, 3.8915, 0.9933, 4.1285, 2.7466, 3.4808],
        [0.5228, 4.5139, 2.9656, 1.5045, 1.2760, 1.8316, 4.0147, 0.1146, 0.2366,
         2.9126, 0.5876, 3.8915, 0.9933, 4.1285, 2.7466, 3.4808],
        [0.5228, 4.5139, 2.9656, 1.5045, 1.2760, 1.8316, 4.0147, 0.1146, 0.2366,
         2.9126, 0.5876, 3.8915, 0.9933, 4.1285, 2.7466, 3.4808],
        [0.5228, 4.5139, 2.9656, 1.5045, 1.2760, 1.8316, 4.0147, 0.1146, 0.2366,
         2.9126, 0.5876, 3.8915, 0.9933, 4.1285, 2.7466, 3.4808],
        [0.5228, 4.5139, 2.9656, 1.5045, 1.2760, 1.8316, 4.0147, 0.1146, 0.2366,
         2.9126, 0.5876, 3.8915, 0.9933, 4.1285, 2.7466, 3.4808],
        [0.5228, 4.5139, 2.9656, 1.5045, 1.2760, 1.8316, 4.0147, 0.1146, 0.2366,
         2.9126, 0.5876, 3.8915, 0.9933, 4.1285, 2.7466, 3.4808],
        [0.5228, 4.5139, 2.9656, 1.5045, 1.2760, 1.8316, 4.0147, 0.1146, 0.2366,
         2.9126, 0.5876, 3.8915, 0.9933, 4.1285, 2.7466, 3.4808],
        [0.5228, 4.5139, 2.9656, 1.5045, 1.2760, 1.8316, 4.0147, 0.1146, 0.2366,
         2.9126, 0.5876, 3.8915, 0.9933, 4.1285, 2.7466, 3.4808],
        [0.5228, 4.5139, 2.9656, 1.5045, 1.2760, 1.8316, 4.0147, 0.1146, 0.2366,
         2.9126, 0.5876, 3.8915, 0.9933, 4.1285, 2.7466, 3.4808],
        [0.5228, 4.5139, 2.9656, 1.5045, 1.2760, 1.8316, 4.0147, 0.1146, 0.2366,
         2.9126, 0.5876, 3.8915, 0.9933, 4.1285, 2.7466, 3.4808],
        [0.5228, 4.5139, 2.9656, 1.5045, 1.2760, 1.8316, 4.0147, 0.1146, 0.2366,
         2.9126, 0.5876, 3.8915, 0.9933, 4.1285, 2.7466, 3.4808],
        [0.5228, 4.5139, 2.9656, 1.5045, 1.2760, 1.8316, 4.0147, 0.1146, 0.2366,
         2.9126, 0.5876, 3.8915, 0.9933, 4.1285, 2.7466, 3.4808]],
       device='cuda:0') 
 

[Ref Adam] step_size: 0.010000000000000002
[Ref Adam] exp_avg: tensor([[-0.0523, -0.4514],
        [-0.0523, -0.4514]], device='cuda:0')
[Ref Adam] denom: tensor([[0.5228, 4.5139, 2.9656, 1.5045, 1.2760, 1.8316, 4.0147, 0.1146, 0.2366,
         2.9126, 0.5876, 3.8915, 0.9933, 4.1285, 2.7466, 3.4808],
        [0.5228, 4.5139, 2.9656, 1.5045, 1.2760, 1.8316, 4.0147, 0.1146, 0.2366,
         2.9126, 0.5876, 3.8915, 0.9933, 4.1285, 2.7466, 3.4808],
        [0.5228, 4.5139, 2.9656, 1.5045, 1.2760, 1.8316, 4.0147, 0.1146, 0.2366,
         2.9126, 0.5876, 3.8915, 0.9933, 4.1285, 2.7466, 3.4808],
        [0.5228, 4.5139, 2.9656, 1.5045, 1.2760, 1.8316, 4.0147, 0.1146, 0.2366,
         2.9126, 0.5876, 3.8915, 0.9933, 4.1285, 2.7466, 3.4808],
        [0.5228, 4.5139, 2.9656, 1.5045, 1.2760, 1.8316, 4.0147, 0.1146, 0.2366,
         2.9126, 0.5876, 3.8915, 0.9933, 4.1285, 2.7466, 3.4808],
        [0.5228, 4.5139, 2.9656, 1.5045, 1.2760, 1.8316, 4.0147, 0.1146, 0.2366,
         2.9126, 0.5876, 3.8915, 0.9933, 4.1285, 2.7466, 3.4808],
        [0.5228, 4.5139, 2.9656, 1.5045, 1.2760, 1.8316, 4.0147, 0.1146, 0.2366,
         2.9126, 0.5876, 3.8915, 0.9933, 4.1285, 2.7466, 3.4808],
        [0.5228, 4.5139, 2.9656, 1.5045, 1.2760, 1.8316, 4.0147, 0.1146, 0.2366,
         2.9126, 0.5876, 3.8915, 0.9933, 4.1285, 2.7466, 3.4808],
        [0.5228, 4.5139, 2.9656, 1.5045, 1.2760, 1.8316, 4.0147, 0.1146, 0.2366,
         2.9126, 0.5876, 3.8915, 0.9933, 4.1285, 2.7466, 3.4808],
        [0.5228, 4.5139, 2.9656, 1.5045, 1.2760, 1.8316, 4.0147, 0.1146, 0.2366,
         2.9126, 0.5876, 3.8915, 0.9933, 4.1285, 2.7466, 3.4808],
        [0.5228, 4.5139, 2.9656, 1.5045, 1.2760, 1.8316, 4.0147, 0.1146, 0.2366,
         2.9126, 0.5876, 3.8915, 0.9933, 4.1285, 2.7466, 3.4808],
        [0.5228, 4.5139, 2.9656, 1.5045, 1.2760, 1.8316, 4.0147, 0.1146, 0.2366,
         2.9126, 0.5876, 3.8915, 0.9933, 4.1285, 2.7466, 3.4808],
        [0.5228, 4.5139, 2.9656, 1.5045, 1.2760, 1.8316, 4.0147, 0.1146, 0.2366,
         2.9126, 0.5876, 3.8915, 0.9933, 4.1285, 2.7466, 3.4808],
        [0.5228, 4.5139, 2.9656, 1.5045, 1.2760, 1.8316, 4.0147, 0.1146, 0.2366,
         2.9126, 0.5876, 3.8915, 0.9933, 4.1285, 2.7466, 3.4808],
        [0.5228, 4.5139, 2.9656, 1.5045, 1.2760, 1.8316, 4.0147, 0.1146, 0.2366,
         2.9126, 0.5876, 3.8915, 0.9933, 4.1285, 2.7466, 3.4808],
        [0.5228, 4.5139, 2.9656, 1.5045, 1.2760, 1.8316, 4.0147, 0.1146, 0.2366,
         2.9126, 0.5876, 3.8915, 0.9933, 4.1285, 2.7466, 3.4808]],
       device='cuda:0')
##### Running MSAMP ##### 

##### Running FP8 ##### 

[FP8Adam] original grad: tensor([[-0.6562, -4.3438],
        [-0.6562, -4.3438]], device='cuda:0')
[FP8Adam] beta1: 0.9, beta2: 0.999
[FP8Adam]: bias_correction1: 0.09999999999999998, bias_correction2: 0.0010000000000000009
[FP8Adam] original fp8 exp_avg: exp_avg.data=FP8Tensor([[0, 0],
           [0, 0]], device='cuda:0', dtype=torch.uint8), exp_avg.fp8_meta=FP8Meta(amax=0.0, scale=1.0, inverse_scale=1.0, dtype=DTypes.FP8E4M3) 
 

[FP8Adam] exp_avg_fp32: tensor([[0., 0.],
        [0., 0.]], device='cuda:0') 
 

[FP8Adam] exp_avg_sq: tensor([[0., 0.],
        [0., 0.]], device='cuda:0', dtype=torch.float16) 
 

[FP8Adam] after mul and add: exp_avg_fp32: tensor([[-0.0656, -0.4344],
        [-0.0656, -0.4344]], device='cuda:0') 
 

[FP8Adam] after mul and add: exp_avg_sq: tensor([[0.0004, 0.0189],
        [0.0004, 0.0189]], device='cuda:0', dtype=torch.float16) 
 

[FP8Adam] denom: tensor([[0.6562, 4.3438, 2.9375, 1.5146, 1.3125, 1.9570, 3.8281, 0.1016, 0.3125,
         2.7188, 0.7974, 3.8203, 0.9941, 4.0664, 2.7910, 3.6562],
        [0.6562, 4.3438, 2.9375, 1.5146, 1.3125, 1.9570, 3.8281, 0.1016, 0.3125,
         2.7188, 0.7974, 3.8203, 0.9941, 4.0664, 2.7910, 3.6562],
        [0.6562, 4.3438, 2.9375, 1.5146, 1.3125, 1.9570, 3.8281, 0.1016, 0.3125,
         2.7188, 0.7974, 3.8203, 0.9941, 4.0664, 2.7910, 3.6562],
        [0.6562, 4.3438, 2.9375, 1.5146, 1.3125, 1.9570, 3.8281, 0.1016, 0.3125,
         2.7188, 0.7974, 3.8203, 0.9941, 4.0664, 2.7910, 3.6562],
        [0.6562, 4.3438, 2.9375, 1.5146, 1.3125, 1.9570, 3.8281, 0.1016, 0.3125,
         2.7188, 0.7974, 3.8203, 0.9941, 4.0664, 2.7910, 3.6562],
        [0.6562, 4.3438, 2.9375, 1.5146, 1.3125, 1.9570, 3.8281, 0.1016, 0.3125,
         2.7188, 0.7974, 3.8203, 0.9941, 4.0664, 2.7910, 3.6562],
        [0.6562, 4.3438, 2.9375, 1.5146, 1.3125, 1.9570, 3.8281, 0.1016, 0.3125,
         2.7188, 0.7974, 3.8203, 0.9941, 4.0664, 2.7910, 3.6562],
        [0.6562, 4.3438, 2.9375, 1.5146, 1.3125, 1.9570, 3.8281, 0.1016, 0.3125,
         2.7188, 0.7974, 3.8203, 0.9941, 4.0664, 2.7910, 3.6562],
        [0.6562, 4.3438, 2.9375, 1.5146, 1.3125, 1.9570, 3.8281, 0.1016, 0.3125,
         2.7188, 0.7974, 3.8203, 0.9941, 4.0664, 2.7910, 3.6562],
        [0.6562, 4.3438, 2.9375, 1.5146, 1.3125, 1.9570, 3.8281, 0.1016, 0.3125,
         2.7188, 0.7974, 3.8203, 0.9941, 4.0664, 2.7910, 3.6562],
        [0.6562, 4.3438, 2.9375, 1.5146, 1.3125, 1.9570, 3.8281, 0.1016, 0.3125,
         2.7188, 0.7974, 3.8203, 0.9941, 4.0664, 2.7910, 3.6562],
        [0.6562, 4.3438, 2.9375, 1.5146, 1.3125, 1.9570, 3.8281, 0.1016, 0.3125,
         2.7188, 0.7974, 3.8203, 0.9941, 4.0664, 2.7910, 3.6562],
        [0.6562, 4.3438, 2.9375, 1.5146, 1.3125, 1.9570, 3.8281, 0.1016, 0.3125,
         2.7188, 0.7974, 3.8203, 0.9941, 4.0664, 2.7910, 3.6562],
        [0.6562, 4.3438, 2.9375, 1.5146, 1.3125, 1.9570, 3.8281, 0.1016, 0.3125,
         2.7188, 0.7974, 3.8203, 0.9941, 4.0664, 2.7910, 3.6562],
        [0.6562, 4.3438, 2.9375, 1.5146, 1.3125, 1.9570, 3.8281, 0.1016, 0.3125,
         2.7188, 0.7974, 3.8203, 0.9941, 4.0664, 2.7910, 3.6562],
        [0.6562, 4.3438, 2.9375, 1.5146, 1.3125, 1.9570, 3.8281, 0.1016, 0.3125,
         2.7188, 0.7974, 3.8203, 0.9941, 4.0664, 2.7910, 3.6562]],
       device='cuda:0', dtype=torch.float16) 
 

[FP8Adam] step_size: 0.010000000000000002 
 

[FP8Adam] updated_exp_avg_fp8: updated_exp_avg_fp8.data=tensor([[232, 254],
        [232, 254]], device='cuda:0', dtype=torch.uint8), exp_avg_fp32_meta=FP8Meta(amax=0.43437501788139343, scale=1024.0, inverse_scale=0.0009765625, dtype=DTypes.FP8E4M3) 
 

[FP8Adam] updated p_fp32: tensor([[ 0.0869,  0.1885,  0.2334,  0.2177,  0.1552,  0.0713, -0.1573, -0.0283,
         -0.2021,  0.0948,  0.2197,  0.2041, -0.1885, -0.0596, -0.1865,  0.1552],
        [ 0.0948,  0.1885, -0.0440, -0.1729,  0.1084, -0.0615, -0.0713,  0.1865,
          0.0948, -0.0014,  0.1104, -0.2490, -0.0401,  0.1553, -0.1396, -0.1729],
        [-0.1006, -0.1396,  0.1709, -0.1416, -0.1182,  0.0635, -0.1260, -0.0869,
          0.2510, -0.1240, -0.1709, -0.1396, -0.2198, -0.0791,  0.1104, -0.1026],
        [ 0.1885, -0.0537, -0.2041,  0.2490, -0.1885, -0.1552,  0.0244,  0.2177,
         -0.1240,  0.0635, -0.1709, -0.1865, -0.1573,  0.0136,  0.0244, -0.1416],
        [ 0.2041,  0.1729, -0.0518, -0.1729,  0.0927, -0.1709,  0.0615,  0.1396,
          0.0948, -0.1865,  0.0283,  0.1416, -0.1573,  0.1162, -0.1162,  0.2177],
        [-0.1396,  0.0069, -0.0264,  0.0283, -0.1260, -0.0537,  0.0044, -0.1260,
         -0.0146, -0.1709,  0.0186,  0.1729,  0.0107,  0.1396, -0.0693,  0.2021],
        [ 0.2198,  0.1416, -0.2198, -0.0596,  0.1084,  0.0244, -0.1026, -0.2198,
         -0.1396, -0.0302,  0.1026,  0.2354, -0.1729,  0.0039,  0.0557, -0.2354],
        [-0.1709, -0.2177,  0.2177, -0.1416, -0.1885,  0.0869, -0.0186,  0.1396,
         -0.1552,  0.1573,  0.1572,  0.0303,  0.2021, -0.2354,  0.0557,  0.0615],
        [-0.1396,  0.0362,  0.0459,  0.1240, -0.0948,  0.1729, -0.0635, -0.2198,
         -0.2334, -0.0263, -0.0342, -0.1865,  0.1396,  0.2021,  0.1260,  0.0053],
        [-0.1396, -0.1709,  0.1709,  0.0771,  0.2021, -0.1865,  0.1240, -0.2354,
         -0.0088,  0.2041,  0.1885, -0.2334,  0.0849,  0.0498,  0.1729,  0.0615],
        [ 0.1182, -0.1396,  0.1396,  0.0927,  0.1865, -0.1552,  0.1396, -0.1182,
         -0.0166,  0.1729, -0.1396, -0.2021, -0.1260,  0.1006,  0.1026,  0.1865],
        [-0.1865, -0.0420,  0.1396,  0.0927, -0.1573,  0.0166,  0.0615,  0.0283,
          0.2354, -0.2021, -0.2178, -0.0283, -0.0948, -0.1885,  0.2354,  0.2334],
        [ 0.1729,  0.1260,  0.0771,  0.0927,  0.0127,  0.0869,  0.0342,  0.1865,
          0.1416, -0.1709, -0.2334,  0.1104,  0.1552, -0.0869, -0.0771,  0.1709],
        [ 0.2041, -0.0381, -0.0596,  0.0498,  0.2021, -0.0498, -0.1182,  0.2021,
          0.1260,  0.1729,  0.1416, -0.2490, -0.1260,  0.1396, -0.0034,  0.1552],
        [-0.0381, -0.2334, -0.0362, -0.1729, -0.0596, -0.2021,  0.0244, -0.0117,
          0.0869, -0.2177, -0.0498,  0.0362, -0.0401, -0.0947,  0.0635,  0.2021],
        [ 0.2198,  0.1104, -0.2198,  0.1709, -0.2198, -0.0381, -0.0322,  0.2021,
          0.2041, -0.0342, -0.0459,  0.0362, -0.0244,  0.2021,  0.0791, -0.1729]],
       device='cuda:0') 
 

[FP8Adam] updated_p_fp8: updated_p_fp8.data=tensor([[107, 116],
        [108, 116]], device='cuda:0', dtype=torch.uint8), p_fp32_meta=FP8Meta(amax=0.25099998712539673, scale=1024.0, inverse_scale=0.0009765625, dtype=DTypes.FP8E4M3) 
 

